<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>14.1 Scoreboard</title>
<style type="text/css">
select { 
  font-size: 1.5em;
}
input { 
  font-size: 1.5em;
}
</style>
</head>

<body id="root" onload="init()">

<table>
<tr>
<td>
<select id="slideA" onchange="updateRack('A', this.value)" size="15" style="text-align:right" />
</td>
<td>
<table>
<tr>
<td> <input id="scoreA" value="0" size="3" type="text" style="text-align:center" /> </td>
<td><u><b>Total</b></u></td>
<td> <input id="scoreB" value="0" size="3" type="text" style="text-align:center" /> </td>
</tr>
<tr>
<td style="text-align:center"> <input id="foulA" value="Fouled" type="button" onclick="foul('A')" /> </td>
<td></td>
<td style="text-align:center"> <input id="foulB" value="Fouled" type="button" onclick="foul('B')" /> </td>
</tr>
<tr>
<td><br><br><br></td>
</tr>
<tr>
<td> <input id="rackA" value="0" size="3" readonly="readonly" type="text" style="text-align:center" /> </td>
<td>Rack</td>
<td> <input id="rackB" value="0" size="3" readonly="readonly" type="text" style="text-align:center" /> </td>
</tr>
</table>
</td>
<td>
<select id="slideB" onchange="updateRack('B', this.value)" size="15" style="text-align:right" />
</td>
</tr>
</table>
<p/>
<input id="rackButton" value="New Rack" type="button" onclick="newRack()" />

<script>
var scoreA = 0, scoreB = 0;

function newRack(){
  var slideA = parseInt(document.getElementById("slideA").value);
  var slideB = parseInt(document.getElementById("slideB").value);
  if(slideA+slideB != 14){
    document.getElementById("rackButton").value = "New Rack -- Fix Rack Score!!!";
    return;
  }
  else{
    document.getElementById("rackButton").value = "New Rack";
  }

  scoreA += slideA;
  scoreB += slideB;
  updateScore();
  appendHistory();

  updateRack("A", 0);
  updateRack("B", 0);
}

function appendHistory(){
  var body = document.getElementById("root");
  var history = document.createTextNode(scoreA + " : " + scoreB + "\n");
  body.appendChild(history);
  body.appendChild(document.createElement("br"));
}

function updateRack(who, score) {
  document.getElementById("rack"+who).value = score;
  document.getElementById("slide"+who).selectedIndex = score;
  var other = who == "A" ? "B" : "A";
  adjustOptions(other, 0, 14-score);
}

function foul(who){
  if(who == "A") scoreA--;
  else scoreB--;
  updateScore();
}

function init(){
  makeSlider("slideA");
  makeSlider("slideB");
}

function makeSlider(id){
  var select = document.getElementById(id);
  for (var i = 0; i <= 14; i++){
    var opt = document.createElement('option');
    opt.value = i;
    opt.innerHTML = i;
    if(i==0) opt.selected = "selected";
    select.appendChild(opt);
  }
}

function adjustOptions(who, low, high){
  var id = "slide" + who;
  var options = document.getElementById(id).getElementsByTagName("option");
  for (var i = 0; i < options.length; i++) {
    var val = parseInt(options[i].value);
    if(low <= val && val <= high){
      options[i].disabled = false;
    }
    else{
      options[i].disabled = true;
    }
  }
}

function updateScore(){
  document.getElementById("scoreA").value = scoreA;
  document.getElementById("scoreB").value = scoreB;
}
</script>
</body>
</html>
