<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>14.1 Scoreboard</title>
<style type="text/css">
select { 
  font-size: 1.5em;
}
input { 
  font-size: 1.5em;
}
</style>
</head>

<body id="root" onload="init()">

<table>
<tr>
<td>
<select id="slideA" onchange="slidedA()" size="15" style="text-align:right" />
</td>
<td>
<table>
<tr>
<td> <input id="scoreA" value="0" size="3" type="text" style="text-align:center" /> </td>
<td><u><b>Total</b></u></td>
<td> <input id="scoreB" value="0" size="3" type="text" style="text-align:center" /> </td>
</tr>
<tr>
<td style="text-align:center"> <input id="foulA" value="Fouled" type="button" onclick="foul('A')" /> </td>
<td></td>
<td style="text-align:center"> <input id="foulB" value="Fouled" type="button" onclick="foul('B')" /> </td>
</tr>
<tr>
<td><br><br><br></td>
</tr>
<tr>
<td> <input id="rackA" value="0" onchange="rackA()" size="3" type="text" style="text-align:center" /> </td>
<td>Rack</td>
<td> <input id="rackB" value="0" onchange="rackB()" size="3" type="text" style="text-align:center" /> </td>
</tr>
</table>
</td>
<td>
<select id="slideB" onchange="slidedB()" size="15" style="text-align:right" />
</td>
</tr>
</table>
<p/>
<input id="rackButton" value="New Rack" type="button" onclick="newRack()" />

<script>
function newRack(){
  var slideA = parseInt(document.getElementById("slideA").value);
  var slideB = parseInt(document.getElementById("slideB").value);
  if(slideA+slideB != 14){
    document.getElementById("rackButton").value = "New Rack -- Fix Rack Score!!!";
    return;
  }
  else{
    document.getElementById("rackButton").value = "New Rack";
  }

  var scoreA = parseInt(document.getElementById("scoreA").value);
  var scoreB = parseInt(document.getElementById("scoreB").value);
  document.getElementById("scoreA").value = scoreA + slideA;
  document.getElementById("scoreB").value = scoreB + slideB;
  appendHistory();

  update("A", 0);
  update("B", 0);
}

function appendHistory(){
  var scoreA = parseInt(document.getElementById("scoreA").value);
  var scoreB = parseInt(document.getElementById("scoreB").value);
  var body = document.getElementById("root");
  var history = document.createTextNode(scoreA + " : " + scoreB + "\n");
  body.appendChild(history);
  body.appendChild(document.createElement("br"));
}

function update(who, score) {
  document.getElementById("rack"+who).value = score;
  document.getElementById("slide"+who).value = score;
  var other = who == "A" ? "B" : "A";
  var otherScore = document.getElementById("rack"+other).value;
  var otherScore = Math.min(otherScore, 14-score);
  document.getElementById("rack"+other).value = otherScore;
  document.getElementById("slide"+other).value = otherScore;
}

function foul(who){
  var id = "score" + who;
  var score = parseInt(document.getElementById(id).value);
  document.getElementById(id).value = --score;
}

function rackA() {
  var score = document.getElementById("rackA").value;
  update("A", score);
}

function rackB() {
  var score = document.getElementById("rackB").value;
  update("B", score);
}

function slidedA() {
  var score = document.getElementById("slideA").value;
  update("A", score);
}

function slidedB() {
  var score = document.getElementById("slideB").value;
  update("B", score);
}

function init(){
  makeSlider("slideA");
  makeSlider("slideB");
}

function makeSlider(id){
  var select = document.getElementById(id);
  for (var i = 0; i <= 14; i++){
    var opt = document.createElement('option');
    opt.value = i;
    opt.innerHTML = i;
    if(i==0) opt.selected = "selected";
    select.appendChild(opt);
  }
}
</script>
</body>
</html>
